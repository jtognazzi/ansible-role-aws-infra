---
# tasks file for ansible-role-aws-infra
- name: upload SSH keys
  local_action:
    module: ec2_key
    name: "{{ lookup('env', 'USER') }}"
    key_material: "{{ lookup('file', '~/.ssh/id_rsa.pub') }}"
    state: present
  run_once: yes

- name: create VM instance started
  local_action:
    module: ec2
    key_name: "{{ lookup('env', 'USER') }}"
    instance_type: "{{ aws_offering }}"
    image: "{{ aws_template }}"
    wait: true
    vpc_subnet_id: vpc-3e90a956
    assign_public_ip: yes    
  register: ec2

- debug:
    var: ec2